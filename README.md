

Кэширующий сервис для изображений.

Забирает на себя всю рутину по отдаче файлов на фронт

Функционал: 


- [x] поддержка проксирования запросов на изображения
  - при отсутствии изображения в кэше мы ходим на основной бэкенд для его получения 
- [x] раздаёт статику (только изображения), поддержка валидации входных файлов
- [x] автоматически конвертирует изображения в нужный формат
  - нужно лишь указать этот формат в ссылке ( по типу https://<server>/<image_id>.<extension>)
- [x] поддерживает автоматическое масштабирование изображений на лету
  - поведение по умолчанию - resize до выбранного размера, достаточно указать параметры `width`, `height`
- [ ] ~~также доступны кроп (обрезка), для этого нужно указать параметр `mode=crop`~~
  - в итоге там другой подход 
- [ ] автоматически настраивает корректную раздачу для статики
  - заголовки для кэширование (etag) 
  - кэширование на стороне браузера (ttl)
  - корректные типы (mime/type)
- [x] кэширование в памяти
- [ ] кэширование на диске?
  - для кэширования можно хэшировать все передаваемые параметры в наименование, 
  - что позволит таки быстро получать данные с диска  
- [x] поддержка предварительной загрузки изображений (через auth токен)
- [ ] готовый докер образ и примеры использования в compose
- [ ] swagger документация
- [ ] понятные и задокументированные ошибки
- [ ] гибкие настройки через .env
  - настройки уровня компресии 
  - настройки размера кэша (по кол-ву изображений, по кол-ву вариаций)
  - включение/отключение кэширования на диске
- [ ] понятный readme с быстрым стартом и пояснением всех настроек
  - отдельные пояснения за кэширование на диске 
- [ ] поддержка S3 как бэкенда для персистентного хранения файлов
  - спойлер, скорее всего не взлетит и быстрее работать с кэшом на лету
  - в этом же пункте подразумеваем S3 как бэкенд для проксирования (если с ним есть какие-то проблемы)
- [ ] бэнчмарки с проверкой разных режимов
- [ ] перейти на https://github.com/Cykooz/fast_image_resize для ресайза
- [x] ~~поддержка адаптивного ресайза (сохранение соотношения сторон при передаче одного из размеров)~~
  - ~~должно работать только при явном передачи type=adaptive~~
  - crop также изменён под другой подход
- [ ] поддержка различных результирующих форматов (не только webp)
- [ ] поддержка redis кэша (для больших сборок)
- [ ] отрефачить всё на image container, с момента получения файла
- [ ] добавить проброс лог параметров на все логи (хранить request id, прокидывать image_id)
- [x] добавить aspect ratio crop
  - если исходное изображение имеет отличное от запрашиваевомого соотношение сторон, мы регулируем поведение через паметр 
    - ratio_policy (resize, crop_center) 
    - вычисляем спроецированное соотношение сторон и кропаем по центру изображения, а потом ресайзим